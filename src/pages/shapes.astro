---
import AnimationToggle from '../components/AnimationToggle.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import Layout from '../layouts/Layout.astro';
import { MorphingOrbGL } from '../components/MorphingOrbGL';
import type { ShapeType } from '../components/MorphingOrbGL/types';

const allShapes: { name: ShapeType; label: string; description: string; animated: boolean }[] = [
  { name: 'gridSphere', label: 'Grid Sphere', description: 'Lat/long grid pattern', animated: false },
  { name: 'offsetSphere', label: 'Offset Sphere', description: 'Hexagonal close-packing', animated: false },
  { name: 'fibSphere', label: 'Fibonacci Sphere', description: 'Golden angle distribution', animated: false },
  { name: 'curvedArcs', label: 'Curved Arcs', description: '3 spinning great circles', animated: true },
  { name: 'orbit', label: 'Orbit', description: 'Single tilted ring', animated: true },
  { name: 'doubleOrbit', label: 'Double Orbit', description: 'Two intersecting rings', animated: true },
  { name: 'trefoilKnot', label: 'Trefoil Knot', description: 'Classic 3-looped knot', animated: true },
  { name: 'torusKnot', label: 'Torus Knot', description: 'Knot wrapping a torus', animated: true },
  { name: 'lemniscate', label: 'Lemniscate', description: '3D figure-eight', animated: true },
  { name: 'pulseSphere', label: 'Pulse Sphere', description: 'Breathing sphere', animated: true },
];

const morphSequence: ShapeType[] = [
  'gridSphere',
  'curvedArcs',
  'offsetSphere',
  'orbit',
  'fibSphere',
  'doubleOrbit',
  'pulseSphere',
  'trefoilKnot',
  'torusKnot',
  'lemniscate',
];

const staticShapes = allShapes.filter(s => !s.animated);
const animatedShapes = allShapes.filter(s => s.animated);
---

<Layout title="Shape Gallery â€” Carterdea">
  <div class="min-h-screen flex flex-col">
    <Header actionHref="/" actionLabel="Back" />

    <main transition:name="page-content" class="flex-1 flex flex-col px-4 md:px-8 py-12">
      <div class="max-w-6xl mx-auto w-full">
        <h1 class="text-3xl md:text-4xl font-medium mb-4">Shape Gallery</h1>
        <p class="text-white/60 mb-8 max-w-2xl">
          All available shapes for the morphing orb animation.
          Each shape can morph smoothly into any other.
        </p>

        <AnimationToggle active="shapes" />

        <!-- Static Shapes -->
        <section class="mb-16">
          <h2 class="text-xl font-medium mb-2">Static Shapes</h2>
          <p class="text-white/50 text-sm mb-8">Volumetric shapes that hold their form</p>

          <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8">
            {staticShapes.map(shape => (
              <div class="flex flex-col items-center">
                <MorphingOrbGL
                  client:visible
                  size={140}
                  variant="color"
                  shapeSequence={[shape.name]}
                  autoMorph={false}
                />
                <p class="text-white/80 text-sm mt-3 font-medium">{shape.label}</p>
                <p class="text-white/40 text-xs text-center">{shape.description}</p>
              </div>
            ))}
          </div>
        </section>

        <!-- Animated Shapes -->
        <section class="mb-16">
          <h2 class="text-xl font-medium mb-2">Animated Shapes</h2>
          <p class="text-white/50 text-sm mb-8">Shapes with continuous motion</p>

          <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8">
            {animatedShapes.map(shape => (
              <div class="flex flex-col items-center">
                <MorphingOrbGL
                  client:visible
                  size={140}
                  variant="color"
                  shapeSequence={[shape.name]}
                  autoMorph={false}
                />
                <p class="text-white/80 text-sm mt-3 font-medium">{shape.label}</p>
                <p class="text-white/40 text-xs text-center">{shape.description}</p>
              </div>
            ))}
          </div>
        </section>

        <!-- Full Morphing Demo -->
        <section class="mb-16">
          <h2 class="text-xl font-medium mb-2">Full Morph Sequence</h2>
          <p class="text-white/50 text-sm mb-8">All shapes cycling through morphs</p>

          <div class="flex items-center gap-8">
            <MorphingOrbGL
              client:visible
              size={400}
              variant="mono"
              shapeSequence={morphSequence}
              autoMorph={true}
              morphDuration={2000}
              holdDuration={2500}
            />
            <div class="flex flex-col items-center">
              <p class="text-white/40 text-xs mb-3 uppercase tracking-wider">Tiny (32px)</p>
              <MorphingOrbGL
                client:visible
                size={32}
                variant="mono"
                shapeSequence={morphSequence}
                autoMorph={true}
                morphDuration={2000}
                holdDuration={2500}
              />
            </div>
          </div>
        </section>

        <!-- WebGL Note -->
        <section class="mb-16 p-4 bg-white/5 rounded-lg">
          <p class="text-white/50 text-sm">
            <strong class="text-white/70">Note:</strong> WebGL has a browser limit of ~8-16 simultaneous contexts.
            This page uses lazy loading to only initialize canvases when scrolled into view.
          </p>
        </section>
      </div>
    </main>

    <Footer />
  </div>
</Layout>
